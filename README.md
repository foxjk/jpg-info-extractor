Please refer to https://www.jianshu.com/p/21ce503f352c for implement details.